<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover">
    <title>Chúc eiuuu 20/10 thật là vui vẻ</title>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" />
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            height: 100%;
            overflow: hidden;
        }

        body {
            height: 100vh;
            width: 100vw;
            position: relative;
            overflow: hidden;
            background: linear-gradient(135deg, #ffeef8 0%, #ffe0f0 50%, #ffd5e5 100%);
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
            font-family: 'Dancing Script', cursive;
        }

        .bg-decoration {
            position: absolute;
            pointer-events: none;
            z-index: 1;
        }

        .flower-corner {
            width: 300px;
            height: 300px;
            opacity: 0.6;
        }

        .flower-top-left {
            top: -50px;
            left: -50px;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200"><circle cx="100" cy="100" r="80" fill="%23ff69b4" opacity="0.3"/><circle cx="70" cy="70" r="60" fill="%23ff1493" opacity="0.3"/><circle cx="130" cy="70" r="60" fill="%23ff69b4" opacity="0.3"/></svg>') no-repeat;
            background-size: contain;
            animation: floatSlow 8s ease-in-out infinite;
        }

        .flower-bottom-right {
            bottom: -50px;
            right: -50px;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200"><circle cx="100" cy="100" r="80" fill="%23ff1493" opacity="0.3"/><circle cx="130" cy="130" r="60" fill="%23ff69b4" opacity="0.3"/><circle cx="70" cy="130" r="60" fill="%23ff1493" opacity="0.3"/></svg>') no-repeat;
            background-size: contain;
            animation: floatSlow 10s ease-in-out infinite;
        }

        @keyframes floatSlow {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(5deg); }
        }

        /* Animation nhánh hoa hồng ở giữa */
        .rose-branch {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 200px;
            height: 200px;
            z-index: 2;
            opacity: 1;
            pointer-events: none;
        }

        .rose-stem {
            position: absolute;
            width: 8px;
            height: 120px;
            background: linear-gradient(to bottom, #2e7d32, #4caf50);
            top: 50%;
            left: 50%;
            transform: translate(-50%, 20px);
            border-radius: 4px;
            z-index: 1;
        }

        .rose-leaf {
            position: absolute;
            width: 40px;
            height: 30px;
            background: #4caf50;
            border-radius: 0 50% 0 50%;
            transform-origin: bottom left;
            z-index: 1;
            animation: leafGrow 2s ease-out forwards;
        }

        .rose-leaf-1 {
            top: 60%;
            left: 48%;
            transform: rotate(-30deg);
            animation-delay: 0.5s;
            opacity: 0;
        }

        .rose-leaf-2 {
            top: 70%;
            left: 52%;
            transform: rotate(140deg);
            animation-delay: 0.8s;
            opacity: 0;
        }

        .rose-bud {
            position: absolute;
            width: 60px;
            height: 60px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -80px);
            z-index: 2;
            opacity: 0;
            animation: budGrow 1.5s ease-out 0.3s forwards;
        }

        .rose-petals {
            position: relative;
            width: 100%;
            height: 100%;
        }

        .rose-petal {
            position: absolute;
            background: linear-gradient(135deg, #ff4081, #f50057);
            border-radius: 50% 50% 40% 40%;
            transform-origin: bottom center;
            opacity: 0;
            box-shadow: 0 2px 8px rgba(245, 0, 87, 0.3);
            animation: petalUnfold 2s ease-out forwards;
        }

        .rose-petal-1 {
            width: 50px;
            height: 40px;
            top: 10px;
            left: 5px;
            transform: rotate(-20deg);
            animation-delay: 1s;
        }

        .rose-petal-2 {
            width: 45px;
            height: 38px;
            top: 8px;
            left: 15px;
            transform: rotate(10deg);
            animation-delay: 1.2s;
        }

        .rose-petal-3 {
            width: 48px;
            height: 42px;
            top: 5px;
            left: 0px;
            transform: rotate(5deg);
            animation-delay: 1.4s;
        }

        .rose-petal-4 {
            width: 52px;
            height: 45px;
            top: 3px;
            left: 8px;
            transform: rotate(-5deg);
            animation-delay: 1.6s;
        }

        @keyframes budGrow {
            0% { opacity: 0; transform: translate(-50%, -80px) scale(0); }
            100% { opacity: 1; transform: translate(-50%, -80px) scale(1); }
        }

        @keyframes petalUnfold {
            0% { opacity: 0; transform: rotate(var(--rotation, 0deg)) scale(0.5); }
            100% { opacity: 1; transform: rotate(var(--rotation, 0deg)) scale(1); }
        }

        @keyframes leafGrow {
            0% { opacity: 0; transform: rotate(var(--rotation, 0deg)) scale(0); }
            100% { opacity: 1; transform: rotate(var(--rotation, 0deg)) scale(1); }
        }

        .falling-heart {
            position: absolute;
            font-size: 1.5rem;
            animation: heartFall 5s linear infinite;
            opacity: 0;
            z-index: 2;
            pointer-events: none;
        }

        .falling-heart-gift {
            position: absolute;
            font-size: 1.5rem;
            animation: heartFall 5s linear infinite;
            opacity: 0;
            z-index: 201;
            pointer-events: none;
        }

        @keyframes heartFall {
            0% { transform: translateY(-50px) rotate(0deg); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 0.6; }
            100% { transform: translateY(100vh) rotate(360deg); opacity: 0; }
        }

        .flower {
            position: absolute;
            width: 50px;
            height: 50px;
            z-index: 2;
            opacity: 0;
            animation: bloom 2s ease-out forwards;
        }

        .flower-petals {
            position: relative;
            width: 100%;
            height: 100%;
            animation: rotate 15s linear infinite;
        }

        .petal {
            position: absolute;
            width: 18px;
            height: 30px;
            background: radial-gradient(ellipse at center, #ff69b4 0%, #ff1493 100%);
            border-radius: 50% 50% 50% 0;
            transform-origin: bottom center;
            opacity: 0;
            animation: petalBloom 1s ease-out forwards;
        }

        .petal:nth-child(1) { transform: rotate(0deg) translateY(-12px); animation-delay: 0s; }
        .petal:nth-child(2) { transform: rotate(72deg) translateY(-12px); animation-delay: 0.1s; }
        .petal:nth-child(3) { transform: rotate(144deg) translateY(-12px); animation-delay: 0.2s; }
        .petal:nth-child(4) { transform: rotate(216deg) translateY(-12px); animation-delay: 0.3s; }
        .petal:nth-child(5) { transform: rotate(288deg) translateY(-12px); animation-delay: 0.4s; }

        .flower-center {
            position: absolute;
            width: 15px;
            height: 15px;
            background: radial-gradient(circle, #ffeb3b 0%, #ffd700 100%);
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            opacity: 0;
            animation: centerBloom 0.4s ease-out 0.5s forwards;
            box-shadow: 0 0 8px rgba(255, 215, 0, 0.6);
        }

        @keyframes bloom {
            0% { opacity: 0; transform: scale(0) rotate(0deg); }
            100% { opacity: 1; transform: scale(1) rotate(360deg); }
        }

        @keyframes petalBloom {
            0% { opacity: 0; transform: rotate(var(--rotation, 0deg)) translateY(0) scale(0); }
            100% { opacity: 1; transform: rotate(var(--rotation, 0deg)) translateY(-12px) scale(1); }
        }

        @keyframes centerBloom {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0); }
            100% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .headline {
            position: absolute;
            top: 15%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 3;
            width: 90vw;
            text-align: center;
            font-family: 'Dancing Script', cursive;
            font-weight: 700;
            font-size: clamp(28px, 6vw, 64px);
            line-height: 1.3;
            background: linear-gradient(90deg, #ff77aa, #f70e8e, #b9515f);
            background-size: 200% 100%;
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            filter: drop-shadow(0 4px 12px rgba(255, 105, 180, 0.4));
            opacity: 1;
            animation: gradientShift 4s linear 1s infinite;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            100% { background-position: 200% 50%; }
        }

        /* Gift Flower */
        .gift-flower {
            position: absolute;
            top: 55%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 100px;
            height: 100px;
            cursor: pointer;
            z-index: 4;
            transition: transform 0.3s ease, opacity 0.6s ease;
            animation: giftPulse 1.5s ease-in-out infinite;
        }

        .gift-flower:hover {
            transform: translate(-50%, -50%) scale(1.1);
        }

        .gift-flower.open {
            transform: translate(-50%, -50%) scale(1.2);
            opacity: 0;
        }

        .gift-flower .flower-petals {
            width: 100%;
            height: 100%;
            animation: rotate 10s linear infinite;
        }

        .gift-flower .petal {
            width: 35px;
            height: 50px;
            background: radial-gradient(ellipse at center, #ff8fb3 0%, #ff1493 100%);
            border-radius: 50% 50% 50% 0;
            transform-origin: bottom center;
            box-shadow: 0 4px 8px rgba(255, 20, 147, 0.3);
        }

        .gift-flower .flower-center {
            width: 25px;
            height: 25px;
            background: radial-gradient(circle, #ffeb3b 0%, #ffd700 100%);
            box-shadow: 0 0 12px rgba(255, 215, 0, 0.8);
        }

        @keyframes giftPulse {
            0%, 100% { transform: translate(-50%, -50%) scale(1); }
            50% { transform: translate(-50%, -50%) scale(1.1); }
        }

        body.hide-ui .headline,
        body.hide-ui .gift-flower,
        body.hide-ui .falling-heart,
        body.hide-ui .flower,
        body.hide-ui .bg-decoration,
        body.hide-ui .rose-branch {
            opacity: 0 !important;
            pointer-events: none !important;
            transition: opacity 0.5s ease !important;
        }

        #letterScene {
            position: absolute;
            inset: 0;
            z-index: 10;
            display: none;
            align-items: center;
            justify-content: center;
            background: rgba(255, 240, 245, 0.95);
            backdrop-filter: blur(5px);
        }

        .envelope-container {
            position: relative;
            cursor: pointer;
            animation: floatEnvelope 3s ease-in-out infinite;
            perspective: 900px;
        }

        @keyframes floatEnvelope {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }

        .envelope {
            position: relative;
            width: 280px;
            height: 180px;
            background: #f08080;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            overflow: visible;
        }

        .envelope::before {
            content: '';
            position: absolute;
            top: -90px;
            left: 0;
            width: 100%;
            height: 90px;
            background: #f4978e;
            clip-path: polygon(0 100%, 50% 0, 100% 100%);
            transform-origin: bottom center;
            transform: rotateX(0deg);
            transition: transform 0.8s cubic-bezier(0.25, 0.8, 0.3, 1), box-shadow 0.3s;
            z-index: 3;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            will-change: transform;
        }

        .envelope-container.opened .envelope::before {
            transform: rotateX(-160deg);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .envelope-card {
            position: absolute;
            width: 250px;
            height: 150px;
            background: #fff;
            top: 15px;
            left: 15px;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-family: 'Dancing Script', cursive;
            font-size: 22px;
            color: #ff1493;
            transition: transform 0.9s cubic-bezier(0.25, 0.8, 0.3, 1) 0.2s, box-shadow 0.4s;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            will-change: transform;
        }

        .envelope-container.opened .envelope-card {
            transform: translateY(-110px) rotate(-2deg) scale(1.02);
            box-shadow: 0 12px 24px rgba(0, 0, 0, 0.2);
        }

        .envelope-card .heart-icon {
            font-size: 40px;
            margin-bottom: 10px;
        }

        .letter-modal {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 100;
            align-items: center;
            justify-content: center;
            padding: 20px;
            opacity: 0;
            transition: opacity 0.6s ease-in;
        }

        .letter-modal.show {
            display: flex;
            opacity: 1;
        }

        .letter-content {
            background: linear-gradient(135deg, #fff 0%, #ffe6f0 100%);
            width: min(600px, 90vw);
            max-height: 85vh;
            border-radius: 20px;
            padding: 40px;
            position: relative;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow-y: auto;
            font-family: 'Dancing Script', cursive;
        }

        .letter-close {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 28px;
            cursor: pointer;
            color: #ff6b9d;
            transition: transform 0.2s;
            z-index: 10;
        }

        .letter-close:hover {
            transform: scale(1.2) rotate(90deg);
        }

        .letter-title {
            font-family: 'Dancing Script', cursive;
            font-size: 32px;
            color: #ff1493;
            text-align: center;
            margin-bottom: 20px;
            min-height: 40px;
            font-weight: 700;
        }

        .letter-text {
            font-family: 'Dancing Script', cursive;
            font-size: 20px;
            line-height: 1.8;
            color: #333;
            text-align: justify;
            margin-bottom: 25px;
            min-height: 100px;
            white-space: pre-line;
        }

        .letter-signature {
            font-family: 'Dancing Script', cursive;
            font-size: 22px;
            color: #ff1493;
            text-align: right;
            font-style: italic;
            margin-top: 20px;
        }

        .letter-next-btn {
            position: absolute;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, #ff6b9d, #ff1493);
            border: none;
            color: white;
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px rgba(255, 20, 147, 0.4);
            transition: transform 0.2s;
        }

        .letter-next-btn:hover {
            transform: scale(1.1);
        }

        .letter-next-btn:active {
            transform: scale(0.95);
        }

        /* Gift Overlay với Video */
        #giftOverlay {
            position: fixed;
            inset: 0;
            z-index: 200;
            display: none;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #ffeef8 0%, #ffe0f0 50%, #ffd5e5 100%);
            opacity: 0;
            transition: opacity 1s ease;
        }

        #giftOverlay.show {
            display: flex;
            opacity: 1;
        }

        .gift-image-wrapper {
            text-align: center;
            animation: zoomIn 1s ease;
            position: relative;
            z-index: 202;
        }

        @keyframes zoomIn {
            from { transform: scale(0); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .gift-video {
            width: min(500px, 80vw);
            height: min(300px, 45vh);
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(255, 20, 147, 0.3);
            border: 5px solid #fff;
        }

        .gift-caption {
            margin-top: 30px;
            font-family: 'Dancing Script', cursive;
            font-size: clamp(22px, 4vw, 36px);
            color: #ff1493;
            text-shadow: 0 2px 4px rgba(255, 20, 147, 0.2);
            min-height: 40px;
        }

        @media (max-width: 768px) {
            .headline {
                font-size: clamp(24px, 7vw, 48px);
                top: 12%;
            }

            .gift-flower {
                width: 80px;
                height: 80px;
                top: 50%;
            }

            .gift-flower .petal {
                width: 28px;
                height: 40px;
            }

            .gift-flower .flower-center {
                width: 20px;
                height: 20px;
            }

            .letter-content {
                padding: 30px 20px;
            }

            .letter-title {
                font-size: 26px;
            }

            .letter-text {
                font-size: 18px;
            }

            .flower-corner {
                width: 200px;
                height: 200px;
            }

            .rose-branch {
                width: 150px;
                height: 150px;
            }

            .rose-stem {
                height: 90px;
            }

            .rose-petal-1 {
                width: 40px;
                height: 32px;
            }

            .rose-petal-2 {
                width: 36px;
                height: 30px;
            }

            .rose-petal-3 {
                width: 38px;
                height: 34px;
            }

            .rose-petal-4 {
                width: 42px;
                height: 36px;
            }

            .gift-video {
                width: 90vw;
                height: 50vh;
            }
        }

        @media (max-width: 480px) {
            .envelope {
                width: 240px;
                height: 160px;
            }

            .envelope-card {
                width: 210px;
                height: 130px;
                font-size: 18px;
            }

            .rose-branch {
                width: 120px;
                height: 120px;
            }

            .rose-stem {
                height: 70px;
            }

            .rose-petal-1 {
                width: 35px;
                height: 28px;
            }

            .rose-petal-2 {
                width: 32px;
                height: 26px;
            }

            .rose-petal-3 {
                width: 33px;
                height: 30px;
            }

            .rose-petal-4 {
                width: 36px;
                height: 32px;
            }

            .gift-video {
                width: 95vw;
                height: 40vh;
            }
        }

        @media (hover: none) and (pointer: coarse) {
            * {
                touch-action: manipulation;
            }
        }
    </style>
</head>
<body>
    <div class="bg-decoration flower-corner flower-top-left"></div>
    <div class="bg-decoration flower-corner flower-bottom-right"></div>

    <!-- Nhánh hoa hồng ở giữa -->
    <div class="rose-branch">
        <div class="rose-stem"></div>
        <div class="rose-leaf rose-leaf-1"></div>
        <div class="rose-leaf rose-leaf-2"></div>
        <div class="rose-bud">
            <div class="rose-petals">
                <div class="rose-petal rose-petal-1"></div>
                <div class="rose-petal rose-petal-2"></div>
                <div class="rose-petal rose-petal-3"></div>
                <div class="rose-petal rose-petal-4"></div>
            </div>
        </div>
    </div>

    <h1 class="headline">Chúc mừng Ngày Phụ nữ Việt Nam 20/10!</h1>

    <div class="gift-flower" id="giftFlower">
        <div class="flower-petals">
            <div class="petal"></div>
            <div class="petal"></div>
            <div class="petal"></div>
            <div class="petal"></div>
            <div class="petal"></div>
        </div>
        <div class="flower-center"></div>
    </div>

    <div id="letterScene">
        <div class="envelope-container" id="envelopeContainer">
            <div class="envelope">
                <div class="envelope-card">
                    <div class="heart-icon">💌</div>
                    <div>Nhấn để đọc thư</div>
                </div>
            </div>
        </div>
    </div>

    <div class="letter-modal" id="letterModal">
        <div class="letter-content">
            <i class="fa-solid fa-xmark letter-close" id="closeModal"></i>
            <div class="letter-title" id="letterTitle"></div>
            <div class="letter-text" id="letterText"></div>
            <div class="letter-signature" id="letterSignature"></div>
            <button class="letter-next-btn" id="nextBtn" title="Tiếp tục">
                <i class="fa-solid fa-arrow-right"></i>
            </button>
        </div>
    </div>

    <!-- ĐÃ THAY THẾ BẰNG VIDEO -->
    <div id="giftOverlay">
        <div class="gift-image-wrapper">
            <iframe 
                class="gift-video"
                src="https://drive.google.com/file/d/1tcCxD562qoQgf1utMn-6T8agGBbz7NR7/preview"
                frameborder="0" 
                allow="autoplay; encrypted-media" 
                allowfullscreen>
            </iframe>
            <div class="gift-caption" id="giftCaption"></div>
        </div>
    </div>

    <audio id="bgMusic" loop>
        <source src="https://cdn.pixabay.com/audio/2022/03/10/audio_4a8f37c0b0.mp3" type="audio/mpeg">
    </audio>

    <script>
        const config = {
            letterTitle: 'Chúc mừng Ngày Phụ nữ Việt Nam 20/10!',
            letterContent: 'Nhân ngày 20/10 chúc em luôn luôn nhiều niềm vui và sức khỏe.\n\nCảm ơn em vì đã luôn là người động viên, mang cho anh những niềm vui, hạnh phúc trong cuộc sống của anh. Anh mong em sẽ luôn luôn hạnh phúc với những gì mình đang có, sẽ luôn hạnh phúc với những gì em đã chọn.\n\nChúng mình tình cờ may mắn gặp nhau, nương tựa vào nhau, anh chẳng thể tin anh lại gặp được một người dthw như em, tinh tế và yêu thương anh. Anh mong cuộc sống của em sẽ luôn tràn đầy niềm vui, tiếng cười và những điều tốt đẹp nhất.\n\nMong e sẽ luôn quan tâm và yêu thương anh hihi! 💕',
            letterSignature: 'iuu em nhiu lam❤️',
            giftCaption: 'Cam on em vi da chon o ben anh, love you! 🌹💐'
        };

        // Tạo trái tim rơi cho phần chính
        function createFallingHearts() {
            const hearts = ['💝', '💓', '💗', '💖', '💕', '❤️'];
            setInterval(() => {
                const heart = document.createElement('div');
                heart.className = 'falling-heart';
                heart.textContent = hearts[Math.floor(Math.random() * hearts.length)];
                heart.style.left = Math.random() * 100 + '%';
                heart.style.animationDuration = (Math.random() * 2 + 4) + 's';
                heart.style.animationDelay = Math.random() * 1 + 's';
                heart.style.fontSize = (Math.random() * 1 + 1) + 'rem';
                document.body.appendChild(heart);
                setTimeout(() => heart.remove(), 7000);
            }, 800);
        }

        // Tạo trái tim rơi cho phần gift overlay
        function createGiftFallingHearts() {
            const hearts = ['💝', '💓', '💗', '💖', '💕', '❤️', '💘', '💞'];
            setInterval(() => {
                const heart = document.createElement('div');
                heart.className = 'falling-heart-gift';
                heart.textContent = hearts[Math.floor(Math.random() * hearts.length)];
                heart.style.left = Math.random() * 100 + '%';
                heart.style.animationDuration = (Math.random() * 2 + 3) + 's';
                heart.style.animationDelay = Math.random() * 0.5 + 's';
                heart.style.fontSize = (Math.random() * 1.5 + 1) + 'rem';
                document.getElementById('giftOverlay').appendChild(heart);
                setTimeout(() => heart.remove(), 7000);
            }, 500); // Tạo nhiều trái tim hơn
        }

        // Tạo hoa nở xung quanh
        function createBloomingFlowers() {
            const positions = [
                { top: '20%', left: '15%' },
                { top: '25%', left: '80%' },
                { top: '60%', left: '10%' },
                { top: '65%', left: '85%' },
                { top: '40%', left: '5%' },
                { top: '45%', left: '92%' }
            ];

            positions.forEach((pos, index) => {
                setTimeout(() => {
                    createFlower(pos.top, pos.left);
                }, index * 500);
            });

            setInterval(() => {
                const top = Math.random() * 70 + 15 + '%';
                const left = Math.random() * 10 < 5 ? Math.random() * 15 + '%' : Math.random() * 15 + 85 + '%';
                createFlower(top, left);
            }, 4000);
        }

        function createFlower(top, left) {
            const flower = document.createElement('div');
            flower.className = 'flower';
            flower.style.top = top;
            flower.style.left = left;
            
            const petals = document.createElement('div');
            petals.className = 'flower-petals';
            
            for (let i = 0; i < 5; i++) {
                const petal = document.createElement('div');
                petal.className = 'petal';
                petal.style.setProperty('--rotation', (i * 72) + 'deg');
                petals.appendChild(petal);
            }
            
            const center = document.createElement('div');
            center.className = 'flower-center';
            
            flower.appendChild(petals);
            flower.appendChild(center);
            document.body.appendChild(flower);
            
            setTimeout(() => {
                flower.style.opacity = '0';
                flower.style.transition = 'opacity 1s';
                setTimeout(() => flower.remove(), 1000);
            }, 8000);
        }

        // Bắt đầu các hiệu ứng
        setTimeout(() => {
            createFallingHearts();
            createBloomingFlowers();
        }, 1000);

        const giftFlower = document.getElementById('giftFlower');
        const bgMusic = document.getElementById('bgMusic');
        let giftOpened = false;

        giftFlower.addEventListener('click', () => {
            if (giftOpened) return;
            giftOpened = true;
            
            giftFlower.classList.add('open');
            
            bgMusic.volume = 0.5;
            bgMusic.play().catch(() => {});

            setTimeout(() => {
                document.body.classList.add('hide-ui');
                document.getElementById('letterScene').style.display = 'flex';
            }, 600);
        });

        const envelopeContainer = document.getElementById('envelopeContainer');
        const letterModal = document.getElementById('letterModal');
        let envelopeOpened = false;

        envelopeContainer.addEventListener('click', () => {
            if (envelopeOpened) return;
            envelopeOpened = true;
            
            envelopeContainer.classList.add('opened');
            
            setTimeout(() => {
                letterModal.classList.add('show');
                typeText('letterTitle', config.letterTitle, 100, () => {
                    typeText('letterText', config.letterContent, 30, () => {
                        typeText('letterSignature', config.letterSignature, 80);
                    });
                });
            }, 1000);
        });

        document.getElementById('closeModal').addEventListener('click', () => {
            letterModal.classList.remove('show');
        });

        document.getElementById('nextBtn').addEventListener('click', () => {
            letterModal.classList.remove('show');
            document.getElementById('letterScene').style.display = 'none';
            
            const overlay = document.getElementById('giftOverlay');
            overlay.classList.add('show');
            
            // Bắt đầu tạo trái tim rơi trong gift overlay
            createGiftFallingHearts();
            
            setTimeout(() => {
                typeText('giftCaption', config.giftCaption, 60);
            }, 1200);
        });

        function typeText(elementId, text, speed, callback) {
            const element = document.getElementById(elementId);
            element.textContent = '';
            let i = 0;
            
            const interval = setInterval(() => {
                if (i < text.length) {
                    element.textContent += text.charAt(i);
                    i++;
                } else {
                    clearInterval(interval);
                    if (callback) callback();
                }
            }, speed);
        }

        // Ngăn chặn zoom trên mobile
        document.addEventListener('gesturestart', e => e.preventDefault());
        document.addEventListener('gesturechange', e => e.preventDefault());
        document.addEventListener('gestureend', e => e.preventDefault());
        
        document.addEventListener('touchmove', e => {
            if (e.touches.length > 1) e.preventDefault();
        }, { passive: false });

        let lastTouchEnd = 0;
        document.addEventListener('touchend', e => {
            const now = Date.now();
            if (now - lastTouchEnd <= 300) e.preventDefault();
            lastTouchEnd = now;
        }, { passive: false });

        document.addEventListener('wheel', e => {
            if (e.ctrlKey) e.preventDefault();
        }, { passive: false });
    </script>
</body>
</html>
