<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover">
    <title>Chúc eiuuu 20/10 thật là vui vẻ</title>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" />
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        html {
            height: 100%;
            overflow: hidden;
            touch-action: manipulation;
        }

        body {
            height: 100vh;
            height: -webkit-fill-available;
            width: 100vw;
            position: relative;
            overflow: hidden;
            background: linear-gradient(135deg, #ffeef8 0%, #ffe0f0 50%, #ffd5e5 100%);
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
            font-family: 'Dancing Script', cursive;
        }

        .bg-decoration {
            position: absolute;
            pointer-events: none;
            z-index: 1;
        }

        .flower-corner {
            width: 200px;
            height: 200px;
            opacity: 0.5;
        }

        @media (min-width: 768px) {
            .flower-corner {
                width: 300px;
                height: 300px;
                opacity: 0.6;
            }
        }

        .flower-top-left {
            top: -30px;
            left: -30px;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200"><circle cx="100" cy="100" r="80" fill="%23ff69b4" opacity="0.3"/><circle cx="70" cy="70" r="60" fill="%23ff1493" opacity="0.3"/><circle cx="130" cy="70" r="60" fill="%23ff69b4" opacity="0.3"/></svg>') no-repeat;
            background-size: contain;
            animation: floatSlow 8s ease-in-out infinite;
        }

        .flower-bottom-right {
            bottom: -30px;
            right: -30px;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200"><circle cx="100" cy="100" r="80" fill="%23ff1493" opacity="0.3"/><circle cx="130" cy="130" r="60" fill="%23ff69b4" opacity="0.3"/><circle cx="70" cy="130" r="60" fill="%23ff1493" opacity="0.3"/></svg>') no-repeat;
            background-size: contain;
            animation: floatSlow 10s ease-in-out infinite;
        }

        @keyframes floatSlow {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-15px) rotate(3deg); }
        }

        /* Animation nhánh hoa hồng ở giữa */
        .rose-branch {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 150px;
            height: 150px;
            z-index: 2;
            opacity: 1;
            pointer-events: none;
        }

        @media (min-width: 768px) {
            .rose-branch {
                width: 200px;
                height: 200px;
            }
        }

        .rose-stem {
            position: absolute;
            width: 6px;
            height: 90px;
            background: linear-gradient(to bottom, #2e7d32, #4caf50);
            top: 50%;
            left: 50%;
            transform: translate(-50%, 15px);
            border-radius: 3px;
            z-index: 1;
        }

        @media (min-width: 768px) {
            .rose-stem {
                width: 8px;
                height: 120px;
                transform: translate(-50%, 20px);
            }
        }

        .rose-leaf {
            position: absolute;
            width: 30px;
            height: 25px;
            background: #4caf50;
            border-radius: 0 50% 0 50%;
            transform-origin: bottom left;
            z-index: 1;
            animation: leafGrow 2s ease-out forwards;
        }

        @media (min-width: 768px) {
            .rose-leaf {
                width: 40px;
                height: 30px;
            }
        }

        .rose-leaf-1 {
            top: 60%;
            left: 48%;
            transform: rotate(-30deg);
            animation-delay: 0.5s;
            opacity: 0;
        }

        .rose-leaf-2 {
            top: 70%;
            left: 52%;
            transform: rotate(140deg);
            animation-delay: 0.8s;
            opacity: 0;
        }

        .rose-bud {
            position: absolute;
            width: 50px;
            height: 50px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -60px);
            z-index: 2;
            opacity: 0;
            animation: budGrow 1.5s ease-out 0.3s forwards;
        }

        @media (min-width: 768px) {
            .rose-bud {
                width: 60px;
                height: 60px;
                transform: translate(-50%, -80px);
            }
        }

        .rose-petals {
            position: relative;
            width: 100%;
            height: 100%;
        }

        .rose-petal {
            position: absolute;
            background: linear-gradient(135deg, #ff4081, #f50057);
            border-radius: 50% 50% 40% 40%;
            transform-origin: bottom center;
            opacity: 0;
            box-shadow: 0 2px 8px rgba(245, 0, 87, 0.3);
            animation: petalUnfold 2s ease-out forwards;
        }

        .rose-petal-1 {
            width: 40px;
            height: 32px;
            top: 8px;
            left: 4px;
            transform: rotate(-20deg);
            animation-delay: 1s;
        }

        .rose-petal-2 {
            width: 36px;
            height: 30px;
            top: 6px;
            left: 12px;
            transform: rotate(10deg);
            animation-delay: 1.2s;
        }

        .rose-petal-3 {
            width: 38px;
            height: 34px;
            top: 4px;
            left: 0px;
            transform: rotate(5deg);
            animation-delay: 1.4s;
        }

        .rose-petal-4 {
            width: 42px;
            height: 36px;
            top: 2px;
            left: 6px;
            transform: rotate(-5deg);
            animation-delay: 1.6s;
        }

        @media (min-width: 768px) {
            .rose-petal-1 {
                width: 50px;
                height: 40px;
                top: 10px;
                left: 5px;
            }
            .rose-petal-2 {
                width: 45px;
                height: 38px;
                top: 8px;
                left: 15px;
            }
            .rose-petal-3 {
                width: 48px;
                height: 42px;
                top: 5px;
                left: 0px;
            }
            .rose-petal-4 {
                width: 52px;
                height: 45px;
                top: 3px;
                left: 8px;
            }
        }

        @keyframes budGrow {
            0% { opacity: 0; transform: translate(-50%, -60px) scale(0); }
            100% { opacity: 1; transform: translate(-50%, -60px) scale(1); }
        }

        @keyframes petalUnfold {
            0% { opacity: 0; transform: rotate(var(--rotation, 0deg)) scale(0.5); }
            100% { opacity: 1; transform: rotate(var(--rotation, 0deg)) scale(1); }
        }

        @keyframes leafGrow {
            0% { opacity: 0; transform: rotate(var(--rotation, 0deg)) scale(0); }
            100% { opacity: 1; transform: rotate(var(--rotation, 0deg)) scale(1); }
        }

        .falling-heart {
            position: absolute;
            font-size: 1.2rem;
            animation: heartFall 5s linear infinite;
            opacity: 0;
            z-index: 2;
            pointer-events: none;
            will-change: transform;
        }

        .falling-heart-gift {
            position: absolute;
            font-size: 1.2rem;
            animation: heartFall 5s linear infinite;
            opacity: 0;
            z-index: 201;
            pointer-events: none;
            will-change: transform;
        }

        @media (min-width: 768px) {
            .falling-heart, .falling-heart-gift {
                font-size: 1.5rem;
            }
        }

        @keyframes heartFall {
            0% { transform: translateY(-50px) rotate(0deg); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 0.6; }
            100% { transform: translateY(100vh) rotate(360deg); opacity: 0; }
        }

        .flower {
            position: absolute;
            width: 40px;
            height: 40px;
            z-index: 2;
            opacity: 0;
            animation: bloom 2s ease-out forwards;
            will-change: transform;
        }

        @media (min-width: 768px) {
            .flower {
                width: 50px;
                height: 50px;
            }
        }

        .flower-petals {
            position: relative;
            width: 100%;
            height: 100%;
            animation: rotate 15s linear infinite;
        }

        .petal {
            position: absolute;
            width: 14px;
            height: 24px;
            background: radial-gradient(ellipse at center, #ff69b4 0%, #ff1493 100%);
            border-radius: 50% 50% 50% 0;
            transform-origin: bottom center;
            opacity: 0;
            animation: petalBloom 1s ease-out forwards;
        }

        @media (min-width: 768px) {
            .petal {
                width: 18px;
                height: 30px;
            }
        }

        .petal:nth-child(1) { transform: rotate(0deg) translateY(-10px); animation-delay: 0s; }
        .petal:nth-child(2) { transform: rotate(72deg) translateY(-10px); animation-delay: 0.1s; }
        .petal:nth-child(3) { transform: rotate(144deg) translateY(-10px); animation-delay: 0.2s; }
        .petal:nth-child(4) { transform: rotate(216deg) translateY(-10px); animation-delay: 0.3s; }
        .petal:nth-child(5) { transform: rotate(288deg) translateY(-10px); animation-delay: 0.4s; }

        .flower-center {
            position: absolute;
            width: 12px;
            height: 12px;
            background: radial-gradient(circle, #ffeb3b 0%, #ffd700 100%);
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            opacity: 0;
            animation: centerBloom 0.4s ease-out 0.5s forwards;
            box-shadow: 0 0 6px rgba(255, 215, 0, 0.6);
        }

        @media (min-width: 768px) {
            .flower-center {
                width: 15px;
                height: 15px;
            }
        }

        @keyframes bloom {
            0% { opacity: 0; transform: scale(0) rotate(0deg); }
            100% { opacity: 1; transform: scale(1) rotate(360deg); }
        }

        @keyframes petalBloom {
            0% { opacity: 0; transform: rotate(var(--rotation, 0deg)) translateY(0) scale(0); }
            100% { opacity: 1; transform: rotate(var(--rotation, 0deg)) translateY(-10px) scale(1); }
        }

        @keyframes centerBloom {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0); }
            100% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .headline {
            position: absolute;
            top: 12%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 3;
            width: 95vw;
            text-align: center;
            font-family: 'Dancing Script', cursive;
            font-weight: 700;
            font-size: clamp(24px, 8vw, 48px);
            line-height: 1.2;
            background: linear-gradient(90deg, #ff77aa, #f70e8e, #b9515f);
            background-size: 200% 100%;
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            filter: drop-shadow(0 2px 8px rgba(255, 105, 180, 0.4));
            opacity: 1;
            animation: gradientShift 4s linear 1s infinite;
            padding: 0 15px;
        }

        @media (min-width: 768px) {
            .headline {
                top: 15%;
                font-size: clamp(28px, 6vw, 64px);
                width: 90vw;
            }
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            100% { background-position: 200% 50%; }
        }

        /* Gift Flower */
        .gift-flower {
            position: absolute;
            top: 55%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80px;
            height: 80px;
            cursor: pointer;
            z-index: 4;
            transition: transform 0.3s ease, opacity 0.6s ease;
            animation: giftPulse 1.5s ease-in-out infinite;
            touch-action: manipulation;
        }

        @media (min-width: 768px) {
            .gift-flower {
                width: 100px;
                height: 100px;
            }
        }

        .gift-flower:active {
            transform: translate(-50%, -50%) scale(1.1);
        }

        .gift-flower.open {
            transform: translate(-50%, -50%) scale(1.2);
            opacity: 0;
        }

        .gift-flower .flower-petals {
            width: 100%;
            height: 100%;
            animation: rotate 10s linear infinite;
        }

        .gift-flower .petal {
            width: 28px;
            height: 40px;
            background: radial-gradient(ellipse at center, #ff8fb3 0%, #ff1493 100%);
            border-radius: 50% 50% 50% 0;
            transform-origin: bottom center;
            box-shadow: 0 4px 8px rgba(255, 20, 147, 0.3);
        }

        @media (min-width: 768px) {
            .gift-flower .petal {
                width: 35px;
                height: 50px;
            }
        }

        .gift-flower .flower-center {
            width: 20px;
            height: 20px;
            background: radial-gradient(circle, #ffeb3b 0%, #ffd700 100%);
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.8);
        }

        @media (min-width: 768px) {
            .gift-flower .flower-center {
                width: 25px;
                height: 25px;
            }
        }

        @keyframes giftPulse {
            0%, 100% { transform: translate(-50%, -50%) scale(1); }
            50% { transform: translate(-50%, -50%) scale(1.1); }
        }

        body.hide-ui .headline,
        body.hide-ui .gift-flower,
        body.hide-ui .falling-heart,
        body.hide-ui .flower,
        body.hide-ui .bg-decoration,
        body.hide-ui .rose-branch {
            opacity: 0 !important;
            pointer-events: none !important;
            transition: opacity 0.5s ease !important;
        }

        #letterScene {
            position: absolute;
            inset: 0;
            z-index: 10;
            display: none;
            align-items: center;
            justify-content: center;
            background: rgba(255, 240, 245, 0.95);
            backdrop-filter: blur(5px);
        }

        .envelope-container {
            position: relative;
            cursor: pointer;
            animation: floatEnvelope 3s ease-in-out infinite;
            perspective: 900px;
            touch-action: manipulation;
        }

        @keyframes floatEnvelope {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .envelope {
            position: relative;
            width: 250px;
            height: 160px;
            background: #f08080;
            border-radius: 8px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
            overflow: visible;
        }

        @media (min-width: 768px) {
            .envelope {
                width: 280px;
                height: 180px;
            }
        }

        .envelope::before {
            content: '';
            position: absolute;
            top: -70px;
            left: 0;
            width: 100%;
            height: 70px;
            background: #f4978e;
            clip-path: polygon(0 100%, 50% 0, 100% 100%);
            transform-origin: bottom center;
            transform: rotateX(0deg);
            transition: transform 0.8s cubic-bezier(0.25, 0.8, 0.3, 1), box-shadow 0.3s;
            z-index: 3;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            will-change: transform;
        }

        @media (min-width: 768px) {
            .envelope::before {
                top: -90px;
                height: 90px;
            }
        }

        .envelope-container.opened .envelope::before {
            transform: rotateX(-160deg);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .envelope-card {
            position: absolute;
            width: 220px;
            height: 130px;
            background: #fff;
            top: 15px;
            left: 15px;
            border-radius: 6px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-family: 'Dancing Script', cursive;
            font-size: 18px;
            color: #ff1493;
            transition: transform 0.9s cubic-bezier(0.25, 0.8, 0.3, 1) 0.2s, box-shadow 0.4s;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            will-change: transform;
        }

        @media (min-width: 768px) {
            .envelope-card {
                width: 250px;
                height: 150px;
                font-size: 22px;
            }
        }

        .envelope-container.opened .envelope-card {
            transform: translateY(-90px) rotate(-2deg) scale(1.02);
            box-shadow: 0 12px 24px rgba(0, 0, 0, 0.2);
        }

        @media (min-width: 768px) {
            .envelope-container.opened .envelope-card {
                transform: translateY(-110px) rotate(-2deg) scale(1.02);
            }
        }

        .envelope-card .heart-icon {
            font-size: 35px;
            margin-bottom: 8px;
        }

        @media (min-width: 768px) {
            .envelope-card .heart-icon {
                font-size: 40px;
                margin-bottom: 10px;
            }
        }

        .letter-modal {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 100;
            align-items: center;
            justify-content: center;
            padding: 15px;
            opacity: 0;
            transition: opacity 0.6s ease-in;
        }

        .letter-modal.show {
            display: flex;
            opacity: 1;
        }

        .letter-content {
            background: linear-gradient(135deg, #fff 0%, #ffe6f0 100%);
            width: min(500px, 95vw);
            max-height: 80vh;
            border-radius: 15px;
            padding: 25px 20px;
            position: relative;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
            overflow-y: auto;
            font-family: 'Dancing Script', cursive;
        }

        @media (min-width: 768px) {
            .letter-content {
                width: min(600px, 90vw);
                max-height: 85vh;
                border-radius: 20px;
                padding: 40px;
            }
        }

        .letter-close {
            position: absolute;
            top: 12px;
            right: 12px;
            font-size: 24px;
            cursor: pointer;
            color: #ff6b9d;
            transition: transform 0.2s;
            z-index: 10;
            touch-action: manipulation;
        }

        @media (min-width: 768px) {
            .letter-close {
                top: 15px;
                right: 15px;
                font-size: 28px;
            }
        }

        .letter-close:active {
            transform: scale(1.2) rotate(90deg);
        }

        .letter-title {
            font-family: 'Dancing Script', cursive;
            font-size: 26px;
            color: #ff1493;
            text-align: center;
            margin-bottom: 15px;
            min-height: 35px;
            font-weight: 700;
        }

        @media (min-width: 768px) {
            .letter-title {
                font-size: 32px;
                margin-bottom: 20px;
                min-height: 40px;
            }
        }

        .letter-text {
            font-family: 'Dancing Script', cursive;
            font-size: 17px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
            margin-bottom: 20px;
            min-height: 80px;
            white-space: pre-line;
        }

        @media (min-width: 768px) {
            .letter-text {
                font-size: 20px;
                line-height: 1.8;
                margin-bottom: 25px;
                min-height: 100px;
            }
        }

        .letter-signature {
            font-family: 'Dancing Script', cursive;
            font-size: 19px;
            color: #ff1493;
            text-align: right;
            font-style: italic;
            margin-top: 15px;
        }

        @media (min-width: 768px) {
            .letter-signature {
                font-size: 22px;
                margin-top: 20px;
            }
        }

        .letter-next-btn {
            position: absolute;
            bottom: 15px;
            right: 15px;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: linear-gradient(135deg, #ff6b9d, #ff1493);
            border: none;
            color: white;
            font-size: 18px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px rgba(255, 20, 147, 0.4);
            transition: transform 0.2s;
            touch-action: manipulation;
        }

        @media (min-width: 768px) {
            .letter-next-btn {
                bottom: 20px;
                right: 20px;
                width: 50px;
                height: 50px;
                font-size: 20px;
            }
        }

        .letter-next-btn:active {
            transform: scale(0.95);
        }

        /* Gift Overlay với Video */
        #giftOverlay {
            position: fixed;
            inset: 0;
            z-index: 200;
            display: none;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #ffeef8 0%, #ffe0f0 50%, #ffd5e5 100%);
            opacity: 0;
            transition: opacity 1s ease;
        }

        #giftOverlay.show {
            display: flex;
            opacity: 1;
        }

        .gift-image-wrapper {
            text-align: center;
            animation: zoomIn 1s ease;
            position: relative;
            z-index: 202;
            width: 95vw;
            max-width: 500px;
        }

        @keyframes zoomIn {
            from { transform: scale(0); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .gift-video {
            width: 100%;
            height: 40vh;
            border-radius: 15px;
            box-shadow: 0 15px 40px rgba(255, 20, 147, 0.3);
            border: 3px solid #fff;
            max-height: 400px;
        }

        @media (min-width: 768px) {
            .gift-video {
                height: 45vh;
                border-radius: 20px;
                border: 5px solid #fff;
            }
        }

        .gift-caption {
            margin-top: 20px;
            font-family: 'Dancing Script', cursive;
            font-size: clamp(18px, 5vw, 28px);
            color: #ff1493;
            text-shadow: 0 2px 4px rgba(255, 20, 147, 0.2);
            min-height: 35px;
            padding: 0 10px;
        }

        @media (min-width: 768px) {
            .gift-caption {
                margin-top: 30px;
                font-size: clamp(22px, 4vw, 36px);
                min-height: 40px;
            }
        }

        /* Mobile optimizations */
        @media (max-width: 480px) {
            .headline {
                top: 10%;
                font-size: clamp(20px, 8vw, 32px);
            }
            
            .gift-flower {
                width: 70px;
                height: 70px;
            }
            
            .gift-flower .petal {
                width: 24px;
                height: 35px;
            }
            
            .gift-flower .flower-center {
                width: 18px;
                height: 18px;
            }
            
            .letter-content {
                padding: 20px 15px;
                margin: 5px;
                max-height: 75vh;
            }
            
            .letter-text {
                font-size: 16px;
                line-height: 1.5;
            }
            
            .gift-video {
                height: 35vh;
            }
        }

        /* Ngăn chặn selection và callout */
        * {
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            -webkit-touch-callout: none;
        }

        /* Đảm bảo không bị zoom trên iOS */
        input, textarea, select, button {
            font-size: 16px;
        }
    </style>
</head>
<body>
    <div class="bg-decoration flower-corner flower-top-left"></div>
    <div class="bg-decoration flower-corner flower-bottom-right"></div>

    <!-- Nhánh hoa hồng ở giữa -->
    <div class="rose-branch">
        <div class="rose-stem"></div>
        <div class="rose-leaf rose-leaf-1"></div>
        <div class="rose-leaf rose-leaf-2"></div>
        <div class="rose-bud">
            <div class="rose-petals">
                <div class="rose-petal rose-petal-1"></div>
                <div class="rose-petal rose-petal-2"></div>
                <div class="rose-petal rose-petal-3"></div>
                <div class="rose-petal rose-petal-4"></div>
            </div>
        </div>
    </div>

    <h1 class="headline">Chúc mừng Ngày Phụ nữ Việt Nam 20/10!</h1>

    <div class="gift-flower" id="giftFlower">
        <div class="flower-petals">
            <div class="petal"></div>
            <div class="petal"></div>
            <div class="petal"></div>
            <div class="petal"></div>
            <div class="petal"></div>
        </div>
        <div class="flower-center"></div>
    </div>

    <div id="letterScene">
        <div class="envelope-container" id="envelopeContainer">
            <div class="envelope">
                <div class="envelope-card">
                    <div class="heart-icon">💌</div>
                    <div>Nhấn để đọc thư</div>
                </div>
            </div>
        </div>
    </div>

    <div class="letter-modal" id="letterModal">
        <div class="letter-content">
            <i class="fa-solid fa-xmark letter-close" id="closeModal"></i>
            <div class="letter-title" id="letterTitle"></div>
            <div class="letter-text" id="letterText"></div>
            <div class="letter-signature" id="letterSignature"></div>
            <button class="letter-next-btn" id="nextBtn" title="Tiếp tục">
                <i class="fa-solid fa-arrow-right"></i>
            </button>
        </div>
    </div>

    <!-- ĐÃ THAY THẾ BẰNG VIDEO -->
    <div id="giftOverlay">
        <div class="gift-image-wrapper">
            <iframe 
                class="gift-video"
                src="https://drive.google.com/file/d/1tcCxD562qoQgf1utMn-6T8agGBbz7NR7/preview"
                frameborder="0" 
                allow="autoplay; encrypted-media" 
                allowfullscreen
                loading="lazy">
            </iframe>
            <div class="gift-caption" id="giftCaption"></div>
        </div>
    </div>

    <audio id="bgMusic" loop>
        <source src="https://cdn.pixabay.com/audio/2022/03/10/audio_4a8f37c0b0.mp3" type="audio/mpeg">
    </audio>

    <script>
        // Kiểm tra thiết bị mobile
        const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        
        const config = {
            letterTitle: 'Chúc mừng Ngày Phụ nữ Việt Nam 20/10!',
            letterContent: 'Nhân ngày 20/10 chúc em luôn luôn nhiều niềm vui và sức khỏe.\n\nCảm ơn em vì đã luôn là người động viên, mang cho anh những niềm vui, hạnh phúc trong cuộc sống của anh. Anh mong em sẽ luôn luôn hạnh phúc với những gì mình đang có, sẽ luôn hạnh phúc với những gì em đã chọn.\n\n Anh chẳng thể tin anh lại gặp được một người dthw như em, tinh tế và yêu thương anh. Anh mong cuộc sống của em sẽ luôn tràn đầy niềm vui, tiếng cười và những điều tốt đẹp nhất.\n\nMong e sẽ luôn quan tâm và yêu thương anh hihi! 💕',
            letterSignature: 'iuu em nhiu lam❤️',
            giftCaption: 'Cam on em vi da chon o ben anh, love you! 🌹💐',
            heartInterval: isMobile ? 1000 : 800,
            flowerInterval: isMobile ? 6000 : 4000
        };

        // Tạo trái tim rơi cho phần chính
        function createFallingHearts() {
            const hearts = ['💝', '💓', '💗', '💖', '💕', '❤️'];
            setInterval(() => {
                const heart = document.createElement('div');
                heart.className = 'falling-heart';
                heart.textContent = hearts[Math.floor(Math.random() * hearts.length)];
                heart.style.left = Math.random() * 100 + '%';
                heart.style.animationDuration = (Math.random() * 2 + 4) + 's';
                heart.style.animationDelay = Math.random() * 1 + 's';
                heart.style.fontSize = (Math.random() * (isMobile ? 0.8 : 1) + 1) + 'rem';
                document.body.appendChild(heart);
                setTimeout(() => {
                    if (heart.parentNode) heart.parentNode.removeChild(heart);
                }, 7000);
            }, config.heartInterval);
        }

        // Tạo trái tim rơi cho phần gift overlay
        function createGiftFallingHearts() {
            const hearts = ['💝', '💓', '💗', '💖', '💕', '❤️', '💘', '💞'];
            const giftHeartInterval = isMobile ? 700 : 500;
            
            setInterval(() => {
                const heart = document.createElement('div');
                heart.className = 'falling-heart-gift';
                heart.textContent = hearts[Math.floor(Math.random() * hearts.length)];
                heart.style.left = Math.random() * 100 + '%';
                heart.style.animationDuration = (Math.random() * 2 + 3) + 's';
                heart.style.animationDelay = Math.random() * 0.5 + 's';
                heart.style.fontSize = (Math.random() * (isMobile ? 1 : 1.5) + 1) + 'rem';
                const giftOverlay = document.getElementById('giftOverlay');
                if (giftOverlay) {
                    giftOverlay.appendChild(heart);
                    setTimeout(() => {
                        if (heart.parentNode) heart.parentNode.removeChild(heart);
                    }, 7000);
                }
            }, giftHeartInterval);
        }

        // Tạo hoa nở xung quanh
        function createBloomingFlowers() {
            const positions = [
                { top: '20%', left: '15%' },
                { top: '25%', left: '80%' },
                { top: '60%', left: '10%' },
                { top: '65%', left: '85%' },
                { top: '40%', left: '5%' },
                { top: '45%', left: '92%' }
            ];

            positions.forEach((pos, index) => {
                setTimeout(() => {
                    createFlower(pos.top, pos.left);
                }, index * 500);
            });

            setInterval(() => {
                const top = Math.random() * 70 + 15 + '%';
                const left = Math.random() * 10 < 5 ? Math.random() * 15 + '%' : Math.random() * 15 + 85 + '%';
                createFlower(top, left);
            }, config.flowerInterval);
        }

        function createFlower(top, left) {
            const flower = document.createElement('div');
            flower.className = 'flower';
            flower.style.top = top;
            flower.style.left = left;
            
            const petals = document.createElement('div');
            petals.className = 'flower-petals';
            
            for (let i = 0; i < 5; i++) {
                const petal = document.createElement('div');
                petal.className = 'petal';
                petal.style.setProperty('--rotation', (i * 72) + 'deg');
                petals.appendChild(petal);
            }
            
            const center = document.createElement('div');
            center.className = 'flower-center';
            
            flower.appendChild(petals);
            flower.appendChild(center);
            document.body.appendChild(flower);
            
            setTimeout(() => {
                flower.style.opacity = '0';
                flower.style.transition = 'opacity 1s';
                setTimeout(() => {
                    if (flower.parentNode) flower.parentNode.removeChild(flower);
                }, 1000);
            }, 8000);
        }

        // Bắt đầu các hiệu ứng
        setTimeout(() => {
            createFallingHearts();
            if (!isMobile) {
                createBloomingFlowers();
            }
        }, 1000);

        const giftFlower = document.getElementById('giftFlower');
        const bgMusic = document.getElementById('bgMusic');
        let giftOpened = false;

        giftFlower.addEventListener('click', function(e) {
            e.preventDefault();
            if (giftOpened) return;
            giftOpened = true;
            
            this.classList.add('open');
            
            bgMusic.volume = 0.3;
            bgMusic.play().catch(e => console.log('Autoplay blocked:', e));

            setTimeout(() => {
                document.body.classList.add('hide-ui');
                document.getElementById('letterScene').style.display = 'flex';
            }, 600);
        });

        const envelopeContainer = document.getElementById('envelopeContainer');
        const letterModal = document.getElementById('letterModal');
        let envelopeOpened = false;

        envelopeContainer.addEventListener('click', function(e) {
            e.preventDefault();
            if (envelopeOpened) return;
            envelopeOpened = true;
            
            this.classList.add('opened');
            
            setTimeout(() => {
                letterModal.classList.add('show');
                typeText('letterTitle', config.letterTitle, 100, () => {
                    typeText('letterText', config.letterContent, isMobile ? 40 : 30, () => {
                        typeText('letterSignature', config.letterSignature, 80);
                    });
                });
            }, 1000);
        });

        document.getElementById('closeModal').addEventListener('click', function(e) {
            e.preventDefault();
            document.getElementById('letterModal').classList.remove('show');
        });

        document.getElementById('nextBtn').addEventListener('click', function(e) {
            e.preventDefault();
            const letterModal = document.getElementById('letterModal');
            letterModal.classList.remove('show');
            document.getElementById('letterScene').style.display = 'none';
            
            const overlay = document.getElementById('giftOverlay');
            overlay.classList.add('show');
            
            // Bắt đầu tạo trái tim rơi trong gift overlay
            createGiftFallingHearts();
            
            setTimeout(() => {
                typeText('giftCaption', config.giftCaption, 60);
            }, 1200);
        });

        function typeText(elementId, text, speed, callback) {
            const element = document.getElementById(elementId);
            if (!element) return;
            
            element.textContent = '';
            let i = 0;
            
            const interval = setInterval(() => {
                if (i < text.length) {
                    element.textContent += text.charAt(i);
                    i++;
                } else {
                    clearInterval(interval);
                    if (callback) callback();
                }
            }, speed);
        }

        // Ngăn chặn các hành vi không mong muốn trên mobile
        document.addEventListener('touchstart', function(e) {
            if (e.touches.length > 1) {
                e.preventDefault();
            }
        }, { passive: false });

        document.addEventListener('gesturestart', function(e) {
            e.preventDefault();
        });

        document.addEventListener('gesturechange', function(e) {
            e.preventDefault();
        });

        document.addEventListener('gestureend', function(e) {
            e.preventDefault();
        });

        // Thông báo khi trang đã tải xong
        window.addEventListener('load', function() {
            console.log('Page loaded successfully on', isMobile ? 'mobile' : 'desktop');
        });
    </script>
</body>
</html>
